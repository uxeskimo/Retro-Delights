[build]
  # Directory to change to before starting a build.
  # This is where we will look for package.json/.nvmrc/etc.
  base = ""

  # Directory (relative to root of your repo) that contains the deploy-ready
  # HTML files and assets generated by the build. If a base directory has
  # been specified, include it in the publish directory path.
  publish = "public"

  # Default build command.
  command = "AWS_LAMBDA_FUNCTION_NAME=trickpuppeteer npm run build"

  [[redirects]]
    from = "/feed/"
    to = "/feed/feed.xml"
    status = 200

[[plugins]]
  package = "netlify-plugin-cloudinary"

 [plugins.inputs]
#########################################
# Cloudinary image optimization redirects
#########################################

# JPG and JPEG
[[redirects]]
  from = "/img/:name.jpg"
  to = "https://res.cloudinary.com/retrodelights/image/fetch/f_auto,q_auto/https://retrodelights.co.uk/cld-assets/img/:name.jpg"
  status = 302
  force = true

[[redirects]]
  from = "/img/:name.jpeg"
  to = "https://res.cloudinary.com/retrodelights/image/fetch/f_auto,q_auto/https://retrodelights.co.uk/cld-assets/img/:name.jpeg"
  status = 302
  force = true

# PNG
[[redirects]]
  from = "/img/:name.png"
  to = "https://res.cloudinary.com/retrodelights/image/fetch/f_auto,q_auto/https://retrodelights.co.uk/cld-assets/img/:name.png"
  status = 302
  force = true

# WebP
[[redirects]]
  from = "/img/:name.webp"
  to = "https://res.cloudinary.com/retrodelights/image/fetch/f_auto,q_auto/https://retrodelights.co.uk/cld-assets/img/:name.webp"
  status = 302
  force = true

#########################################
# Internal rewrites and feed redirect
#########################################

# Internal rewrite for /cld-assets/img/*
[[redirects]]
  from = "/cld-assets/img/*"
  to = "/img/:splat"
  status = 200
  force = true

# Feed redirect
[[redirects]]
  from = "/feed/"
  to = "/feed/feed.xml"
  status = 200
  force = false



 
